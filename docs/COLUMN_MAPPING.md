# スプレッドシート列構造と4象限マトリクス対応表

## 現在の列構造（タスクシート）

| 列番号 | 列名 | 列インデックス | 定数名 | 説明 |
|--------|------|---------------|--------|------|
| A (1) | ID | 0 | `TASK_COL_ID` | タスクID（数値） |
| B (2) | タイトル | 1 | `TASK_COL_TITLE` | タスクのタイトル |
| C (3) | 説明 | 2 | `TASK_COL_DESCRIPTION` | タスクの説明 |
| D (4) | 見積もり時間 | 3 | `TASK_COL_ESTIMATED_HOURS` | 見積もり時間（数値） |
| E (5) | 優先度 | 4 | `TASK_COL_PRIORITY` | 優先度（高/中/低） |
| F (6) | 重要度 | 5 | `TASK_COL_IMPORTANCE` | 重要度（高/中/低） |
| G (7) | 提出先 | 6 | `TASK_COL_DELIVERABLE` | 提出先（任意） |
| H (8) | 締切日 | 7 | `TASK_COL_DEADLINE` | 締切日（YYYY-MM-DD形式） |
| I (9) | ステータス | 8 | `TASK_COL_STATUS` | ステータス（未着手/進行中/完了/キャンセル） |
| J (10) | 作成日時 | 9 | `TASK_COL_CREATED_AT` | 作成日時（ISO形式） |
| K (11) | 更新日時 | 10 | `TASK_COL_UPDATED_AT` | 更新日時（ISO形式） |

## 4象限マトリクス値と優先度・重要度の対応関係

フロントエンドで選択される「タスクの優先度・重要度」は、以下のように優先度と重要度に変換されます：

| マトリクス値（フロントエンド） | 優先度（列E） | 重要度（列F） | 説明 |
|----------------------------|------------|------------|------|
| 高優先/高重要（最優先） | 高 | 高 | 最優先で対応すべきタスク |
| 高優先/低重要（急いで対応） | 高 | 低 | 急いで対応が必要だが、成果は限定的 |
| 低優先/高重要（計画的に実行） | 低 | 高 | 計画的に実行すべき重要なタスク |
| 低優先/低重要（後回し可） | 低 | 低 | 後回しにできるタスク |

## 現在の実装について

**現在の実装では、列構造の変更は不要です。**

- フロントエンドで4象限マトリクス値を選択
- JavaScriptで優先度・重要度に変換
- 既存の列E（優先度）と列F（重要度）に保存

## 列構造を変更する場合の提案

もし、マトリクス値を直接保存したい場合は、以下のような変更が考えられます：

### オプション1: 優先度列をマトリクス値に置き換え

| 列番号 | 列名 | 列インデックス | 説明 |
|--------|------|---------------|------|
| E (5) | 優先度・重要度 | 4 | マトリクス値（高優先/高重要、高優先/低重要、低優先/高重要、低優先/低重要） |
| F (6) | （削除または別用途） | 5 | 重要度列を削除、または別の用途に使用 |

**注意**: この場合、`Code.gs`の以下の定数と処理を変更する必要があります：
- `TASK_COL_PRIORITY` → `TASK_COL_MATRIX` に変更
- `TASK_COL_IMPORTANCE` を削除または別用途に
- `TASK_COLUMN_COUNT` を10に変更
- `getTasks()`, `addTask()`, `updateTask()` の処理を変更

### オプション2: 新しい列を追加

| 列番号 | 列名 | 列インデックス | 説明 |
|--------|------|---------------|------|
| E (5) | 優先度 | 4 | 既存のまま（後方互換性のため） |
| F (6) | 重要度 | 5 | 既存のまま（後方互換性のため） |
| L (12) | 優先度・重要度 | 11 | 新しい列：マトリクス値 |

**注意**: この場合、`TASK_COLUMN_COUNT` を12に変更し、新しい列の処理を追加する必要があります。

## 推奨事項

**現在の実装（列構造変更なし）を推奨します。**

理由：
1. 既存のデータとの互換性が保たれる
2. コードの変更が最小限
3. 優先度・重要度の個別の値も保持できる
4. 将来的にマトリクス以外の並び替えやフィルタリングも可能

もし列構造を変更する場合は、上記の対応表を参考に、`Code.gs`の定数定義と各関数の処理を更新してください。


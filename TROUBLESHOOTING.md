# トラブルシューティングガイド

## エラー: "Cannot read properties of undefined (reading 'getSheetByName')"

このエラーは、スプレッドシートへのアクセスが失敗していることを示しています。

### 解決方法

1. **Webアプリを再デプロイする**
   - [GASエディタ](https://script.google.com/d/1OZNbk3v9kgRPDPvsLlaShtG1DhCfMCYdtpnXaRqbX1nqtKS_11ETpPQ_/edit) を開く
   - 「デプロイ」→「デプロイを管理」をクリック
   - 最新のデプロイを選択して「編集」をクリック
   - 「新しいバージョン」を選択して「デプロイ」をクリック
   - または、新しいデプロイを作成

2. **権限の確認**
   - Webアプリの設定で「次のユーザーとして実行」が「自分」になっているか確認
   - スプレッドシート（ID: `1mB9nhSma1jiUOhjQpN2Ae9Ib8unc_Ixq6WAEY3geydU`）へのアクセス権限があるか確認
   - GASエディタで「実行」→「initializeSpreadsheet」を実行して、権限を再承認

3. **スプレッドシートの共有設定**
   - スプレッドシートが自分のアカウントで作成されているか確認
   - 必要に応じて、スプレッドシートの共有設定を確認

## エラー: "tasks.filter is not a function"

このエラーは、`getTasks()`がエラーオブジェクトを返している場合に発生します。

### 解決方法

1. 上記の「Cannot read properties of undefined」の解決方法を実行
2. ブラウザのキャッシュをクリアしてページを再読み込み（Ctrl+Shift+R または Cmd+Shift+R）
3. GASエディタの実行ログを確認：
   - GASエディタで「表示」→「ログ」を開く
   - エラーの詳細を確認

## Webアプリが更新されない

### 解決方法

1. **強制リロード**
   - ブラウザで Ctrl+Shift+R（Windows）または Cmd+Shift+R（Mac）を押す
   - または、シークレットモードで開く

2. **新しいデプロイを作成**
   - GASエディタで「デプロイ」→「新しいデプロイ」
   - 新しいURLが生成されるので、それを使用

3. **バージョン番号を確認**
   - デプロイ管理画面で、最新のバージョンがデプロイされているか確認

## カレンダーが表示されない

### 解決方法

1. **Googleカレンダーのデフォルトカレンダーを確認**
   - Googleカレンダーでデフォルトカレンダーが設定されているか確認
   - カレンダーに予定があるか確認

2. **権限の確認**
   - GASエディタでカレンダーへのアクセス権限が許可されているか確認
   - 必要に応じて、権限を再承認

## よくある質問

### Q: スプレッドシートは初期化されているのに、エラーが出る

A: Webアプリが古いバージョンのコードを実行している可能性があります。新しいデプロイを作成してください。

### Q: タスクを追加しても反映されない

A: ブラウザのキャッシュをクリアして、ページを再読み込みしてください。また、スプレッドシートを直接確認して、データが保存されているか確認してください。

### Q: 権限エラーが出る

A: GASエディタで「実行」→「initializeSpreadsheet」を実行して、権限を再承認してください。

